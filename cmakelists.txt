cmake_minimum_required(VERSION 3.12)
project(SimpleRenderer CXX)

# 设置 C++20 标准
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# 添加texture子目录
add_subdirectory(src/lib/texture)

# 添加可执行文件
set(SRC_LIST 
    main.cpp
    test.cpp
    src/lib/maths.cpp
    src/core/renderer.cpp
    src/core/mesh.cpp
    src/core/texture.cpp
    src/core/scene.cpp
    src/core/material.cpp
    src/shader/basic_shader.cpp
    src/shader/phong_shader.cpp  
    src/shader/shadow_map_shader.cpp
)

add_executable(SimpleRenderer ${SRC_LIST})

# 添加头文件目录
target_include_directories(SimpleRenderer PRIVATE 
    ${CMAKE_CURRENT_SOURCE_DIR}
    ${CMAKE_CURRENT_SOURCE_DIR}/src
    ${CMAKE_CURRENT_SOURCE_DIR}/src/lib
    ${CMAKE_CURRENT_SOURCE_DIR}/src/core
    ${CMAKE_CURRENT_SOURCE_DIR}/src/shader
)

# 链接texture库
target_link_libraries(SimpleRenderer PRIVATE texture)

# 设置资源目录
set(ASSETS_DIR "${CMAKE_CURRENT_SOURCE_DIR}/../assets")
set(OUTPUT_DIR "${CMAKE_CURRENT_SOURCE_DIR}/../output")

# # 创建输出目录
# file(MAKE_DIRECTORY ${OUTPUT_DIR})

# # 复制资源文件到构建目录以便于运行时访问
# file(GLOB OBJ_FILES "${ASSETS_DIR}/*.obj")
# file(GLOB TGA_FILES "${ASSETS_DIR}/*.tga")

# foreach(OBJ_FILE ${OBJ_FILES})
#     file(COPY ${OBJ_FILE} DESTINATION ${CMAKE_CURRENT_BINARY_DIR})
# endforeach()

# foreach(TGA_FILE ${TGA_FILES})
#     file(COPY ${TGA_FILE} DESTINATION ${CMAKE_CURRENT_BINARY_DIR})
# endforeach()

# # 修改输出路径
# set_target_properties(SimpleRenderer
#     PROPERTIES
#     RUNTIME_OUTPUT_DIRECTORY ${OUTPUT_DIR}
# )